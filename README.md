### Generated by BLACKBOX.AI
https://www.blackbox.ai
### YOU
напиши для данного плагина подробный MarkDown в формате .md
### BLACKBOX.AI



Конечно, вот подробный файл `README.md` для плагина "Cache monitoring":

---

# Cache monitoring

**Полный мониторинг кэширования: OPcache + JIT + APCu + Memcached + Object Cache Pro (Redis)**

[![Version](https://img.shields.io/badge/version-1.0.0-blue.svg)](https://github.com/RobertoBennett/cache-monitoring)
[![License](https://img.shields.io/badge/license-GPL--2.0-green.svg)](https://www.gnu.org/licenses/gpl-2.0.html)
[![Author](https://img.shields.io/badge/author-Robert%20Bennett-lightgrey.svg)](https://github.com/RobertoBennett/)

## Описание

Плагин "Cache monitoring" предоставляет комплексный инструмент для мониторинга и управления различными типами кэша в вашей среде WordPress. Он позволяет отслеживать состояние и производительность OPcache, JIT, APCu, Memcached, Object Cache Pro (Redis), а также PCRE JIT, предоставляя подробную статистику и возможность очистки кэша прямо из админ-панели WordPress.

Этот плагин идеально подходит для разработчиков, системных администраторов и владельцев сайтов, которые хотят оптимизировать производительность своего WordPress, глубоко понимая, как работают их механизмы кэширования.

## Возможности

*   **OPcache Мониторинг:**
    *   Статус OPcache (активен/неактивен).
    *   Коэффициент попаданий (Hit Rate).
    *   Количество кэшированных файлов.
    *   Использование памяти (занято/свободно).
    *   Возможность сброса OPcache.
*   **JIT Статистика (для PHP 8.0+):**
    *   Статус JIT (активен/неактивен).
    *   Размер буфера JIT.
    *   Количество скомпилированных функций.
    *   Использование буфера JIT.
*   **APCu Мониторинг:**
    *   Коэффициент попаданий (Hit Rate).
    *   Количество записей в кэше.
    *   Использование памяти APCu.
    *   Возможность очистки APCu кэша.
*   **Memcached Мониторинг:**
    *   Коэффициент попаданий (Hit Rate).
    *   Количество элементов в кэше.
    *   Использование памяти Memcached.
    *   Возможность сброса Memcached кэша.
*   **Object Cache Pro (Redis) Мониторинг:**
    *   Статус подключения к Redis.
    *   Коэффициент попаданий (Hit Rate).
    *   Количество ключей в Redis.
    *   Использование памяти Redis.
    *   Определение активности плагина Object Cache Pro.
    *   Возможность сброса Redis кэша.
*   **PCRE JIT Статистика:**
    *   Статус PCRE JIT (включен/выключен).
    *   Версия PCRE.
    *   Лимиты рекурсии и отката.
*   **Тесты Производительности:**
    *   Бенчмарки для математических операций (JIT), операций с регулярными выражениями (PCRE), операций APCu, Memcached и Redis для оценки скорости работы кэшей.
*   **Управление Кэшем:**
    *   Кнопки для индивидуальной очистки OPcache, APCu, Memcached и Redis.
    *   Кнопка для **полной очистки всех поддерживаемых кэшей** (OPcache, APCu, Memcached, Redis).
*   **Системная Информация:**
    *   Версия PHP, время сервера, лимит памяти PHP, версия WordPress.
*   **Удобный Интерфейс:**
    *   Интуитивно понятный дашборд в админ-панели WordPress.
    *   Автоматическое обновление статистики (с возможностью включения/выключения).

## Установка

1.  **Загрузка:** Загрузите файлы плагина в директорию `/wp-content/plugins/cache-monitoring/`.
2.  **Активация:** Активируйте плагин через меню "Плагины" в админ-панели WordPress.
3.  **Доступ:** После активации плагин будет доступен в меню "Инструменты" -> "Cache Monitor".

### Требования

*   WordPress 4.0+
*   PHP 7.0+ (для JIT требуется PHP 8.0+)
*   Соответствующие расширения PHP для кэшей, которые вы хотите мониторить (например, `opcache`, `apcu`, `memcached`, `redis`).

## Использование

После установки и активации плагина перейдите в **Инструменты -> Cache Monitor** в вашей админ-панели WordPress.

На странице мониторинга вы увидите:

*   **Обзор состояния каждого типа кэша:** OPcache, JIT, APCu, Memcached, Object Cache Pro (Redis), PCRE JIT.
*   **Подробную статистику** по каждому кэшу, включая коэффициент попаданий, использование памяти и количество элементов.
*   **Блок "Performance Benchmark"** с результатами тестов производительности для различных операций кэширования.
*   **Блок "Cache Management"** с кнопками для очистки каждого типа кэша по отдельности или всех кэшей сразу.
*   **Кнопка "Refresh All"** для ручного обновления статистики.
*   **Кнопка "Auto Refresh: OFF/ON"** для включения/выключения автоматического обновления статистики каждые 10 секунд.

### Очистка Кэша

*   **Clear OPcache:** Сбрасывает весь OPcache, удаляя все скомпилированные PHP-файлы.
*   **Clear APCu:** Очищает пользовательский кэш APCu.
*   **Flush Memcached:** Сбрасывает все данные из Memcached.
*   **Flush Redis:** Сбрасывает все данные из Redis (через Object Cache Pro или прямое подключение).
*   **Flush ALL Caches:** **ВНИМАНИЕ!** Эта кнопка выполняет полную очистку всех поддерживаемых кэшей (OPcache, APCu, Memcached, Redis). Используйте с осторожностью, так как это может временно повлиять на производительность сайта.

## Разработка

Плагин использует AJAX для получения статистики и выполнения операций очистки кэша, что обеспечивает динамическое обновление данных без перезагрузки страницы.

### Хуки AJAX

*   `wp_ajax_opcache_reset`: Сброс OPcache.
*   `wp_ajax_apcu_clear`: Очистка APCu.
*   `wp_ajax_memcached_flush`: Сброс Memcached.
*   `wp_ajax_redis_flush`: Сброс Redis/Object Cache Pro.
*   `wp_ajax_opcache_get_stats`: Получение всей статистики кэша.

Все AJAX-запросы защищены с помощью `wp_nonce` для предотвращения CSRF-атак и требуют прав `manage_options`.

### Функции

*   `get_redis_stats()`: Вспомогательная функция для сбора подробной статистики Redis, включая проверку Object Cache Pro, использование памяти, коэффициент попаданий и количество ключей.
*   `test_redis_performance()`: Функция для измерения производительности операций чтения/записи в Redis.

## Стилизация

Плагин включает базовые CSS-стили для улучшения внешнего вида дашборда в админ-панели, используя стандартные классы WordPress и некоторые пользовательские стили для отображения статусов и графиков.

## Часто задаваемые вопросы

**В: Почему некоторые разделы кэша показывают "Not available"?**
О: Это означает, что соответствующее расширение PHP для данного типа кэша не установлено или не включено на вашем сервере, либо сам сервис кэширования (например, Memcached или Redis) не запущен или недоступен. Убедитесь, что все необходимые расширения PHP установлены и настроены правильно.

**В: Безопасно ли использовать кнопку "Flush ALL Caches"?**
О: Эта кнопка предназначена для быстрой очистки всех поддерживаемых кэшей. Она безопасна в плане функциональности, но её использование может временно снизить производительность вашего сайта, так как весь кэш будет сброшен, и данные придется генерировать заново. Используйте её, когда это действительно необходимо, например, после крупных обновлений или изменений конфигурации.

**В: Могу ли я использовать этот плагин на продакшн-сайте?**
О: Да, плагин разработан с учетом безопасности и производительности. Однако, как и с любым инструментом для управления кэшем, рекомендуется быть осторожным при очистке кэша на продакшн-сайте, особенно во время пиковых нагрузок.

## Лицензия

Этот плагин распространяется под лицензией GPL-2.0. Подробности смотрите в файле `LICENSE`.

## Автор

Robert Bennett
[GitHub Профиль](https://github.com/RobertoBennett/)

---
### YOU
напиши для данного плагина подробный MarkDown в формате .md
### BLACKBOX.AI

Конечно, вот подробный `README.md` файл для плагина "Advanced Security IP Blocker", основанный на предоставленном PHP-коде:

---

# Advanced Security IP Blocker

**Продвинутая система безопасности для WordPress: блокировка IP, защита wp-login.php и xmlrpc.php, блокировка опасных файлов и ботов с поддержкой ASN, автоматическая блокировка при брутфорс атаках.**

[![Version](https://img.shields.io/badge/version-1.0.0-blue.svg)](https://github.com/RobertoBennett/IP-Blocker-Manager)
[![License](https://img.shields.io/badge/license-GPL--2.0-green.svg)](https://www.gnu.org/licenses/gpl-2.0.html)
[![Author](https://img.shields.io/badge/author-Robert%20Bennett-lightgrey.svg)](https://github.com/RobertoBennett/)

## Описание

Плагин "Advanced Security IP Blocker" предоставляет комплексное решение для защиты вашего сайта WordPress от различных угроз, включая брутфорс атаки, нежелательный трафик, доступ к конфиденциальным файлам и активность вредоносных ботов. Плагин работает на уровне `.htaccess` и WordPress, обеспечивая мощную и гибкую защиту.

### Ключевые особенности:

*   **Блокировка IP-адресов:** Ручная и автоматическая блокировка IP-адресов и CIDR-диапазонов.
*   **Поддержка ASN:** Блокировка целых автономных систем (ASN) для эффективной борьбы с крупными источниками спама и атак.
*   **Защита wp-login.php и xmlrpc.php:** Ограничение доступа к критически важным файлам WordPress, позволяя доступ только с разрешенных IP-адресов или ASN.
*   **Блокировка опасных файлов:** Защита от прямого доступа к конфиденциальным файлам, таким как `.htaccess`, `wp-config.php`, логи и резервные копии. Поддержка масок файлов.
*   **Защита от ботов:** Блокировка нежелательных User-Agent, включая спам-ботов, сканеры уязвимостей и парсеры.
*   **Автоматическая защита от брутфорс атак:** Интеллектуальная система, которая автоматически блокирует IP-адреса после заданного количества неудачных попыток входа.
*   **Управление блокировками:** Удобный интерфейс для просмотра, разблокировки и ручного добавления IP-адресов в черный и белый списки.
*   **Логирование и статистика:** Подробная статистика попыток входа и история блокировок для анализа угроз.
*   **Email-уведомления:** Оповещения администратора о заблокированных IP-адресах.
*   **Резервное копирование .htaccess:** Автоматическое создание резервных копий файла `.htaccess` перед внесением изменений.
*   **Очистка кэша:** Интегрированная функция для очистки различных типов кэша после изменения правил безопасности.

## Установка

1.  **Загрузка:** Загрузите файлы плагина в директорию `/wp-content/plugins/advanced-security-ip-blocker/`.
2.  **Активация:** Активируйте плагин через меню "Плагины" в админ-панели WordPress.
3.  **Доступ:** После активации плагин будет доступен в меню "Настройки" -> "Безопасность".

### Требования

*   WordPress 4.0+
*   PHP 7.0+
*   Права на запись в файл `.htaccess` (обычно `/var/www/html/.htaccess` или в корневой директории WordPress).
*   Расширения PHP `curl` или `allow_url_fopen` для получения информации по ASN.

## Использование

После установки и активации плагина перейдите в **Настройки -> Безопасность** в вашей админ-панели WordPress.

Интерфейс плагина разделен на несколько вкладок для удобного управления:

### 1. Блокировка IP

*   **Назначение:** Ручная блокировка IP-адресов, CIDR-диапазонов и целых автономных систем (ASN).
*   **Форматы:**
    *   Отдельные IP: `192.168.1.100`
    *   CIDR диапазоны: `192.168.1.0/24`
    *   ASN (автономные системы): `AS15169` или `15169` (плагин автоматически преобразует ASN в IP-диапазоны).
*   **Действие:** Все указанные IP-адреса будут заблокированы на уровне `.htaccess`.

### 2. Защита wp-login.php и xmlrpc.php

*   **Назначение:** Ограничение доступа к страницам входа (`wp-login.php`) и XML-RPC интерфейсу (`xmlrpc.php`) только для разрешенных IP-адресов.
*   **Важно:** **Обязательно добавьте свой текущий IP-адрес в белый список**, чтобы не потерять доступ к админ-панели. Ваш текущий IP отображается на этой вкладке.
*   **Разрешенные IP:** Укажите IP-адреса, CIDR-диапазоны или ASN, которым разрешен доступ.
*   **Форматы разрешенных IP:**
    *   Отдельные IP: `192.168.1.100`
    *   CIDR диапазоны: `192.168.1.0/24`
    *   ASN: `AS15169` или `15169`
    *   Маска подсети: `192.168.1.0 255.255.255.0`
    *   Частичные IP: `192.168.1` (блокирует все IP, начинающиеся с `192.168.1.`)
*   **Рекомендация:** Если вы не используете мобильные приложения WordPress или внешние сервисы, рекомендуется заблокировать `xmlrpc.php`, так как он часто используется для брутфорс атак.

### 3. Блокировка опасных файлов

*   **Назначение:** Запрет прямого доступа к файлам, которые могут содержать конфиденциальную информацию или использоваться для атак.
*   **Примеры файлов:** `.htaccess`, `.htpasswd`, `wp-config.php`, `readme.html`, `license.txt`, `*.sql`, `*.log`, `*.bak`, `error_log` и т.д.
*   **Поддержка масок:** Вы можете использовать маски файлов (например, `*.log` для блокировки всех файлов с расширением `.log`).

### 4. Защита от ботов

*   **Назначение:** Блокировка доступа к сайту для нежелательных User-Agent (идентификаторов ботов).
*   **Формат:** Список User-Agent, разделенных символом `|` (вертикальная черта).
*   **Пример:** `BadBot|SpamBot|Crawler`
*   **Действие:** Плагин использует правила `SetEnvIfNoCase` в `.htaccess` для блокировки запросов от указанных User-Agent.

### 5. Защита от брутфорс атак

*   **Назначение:** Автоматическая блокировка IP-адресов, которые совершают слишком много неудачных попыток входа в админ-панель.
*   **Настройки:**
    *   **Включить защиту:** Активирует/деактивирует автоматическую блокировку.
    *   **Максимум попыток:** Количество неудачных попыток входа, после которых IP будет заблокирован.
    *   **Временное окно (минуты):** Период времени, в течение которого подсчитываются попытки.
    *   **Длительность блокировки (минуты):** Как долго IP будет заблокирован. Установка `0` означает постоянную блокировку (требует ручной разблокировки).
    *   **Добавлять в .htaccess:** Если включено, заблокированные IP будут добавлены в `.htaccess` для более быстрой блокировки. Если отключено, блокировка будет работать только на уровне WordPress.
    *   **Email уведомления:** Отправлять ли администратору уведомления о блокировках.
*   **Статистика:** Отображает общее количество попыток входа, заблокированных IP-адресов, топ IP по попыткам и последние попытки входа. Статистика обновляется в реальном времени.
*   **Очистить старые записи:** Кнопка для удаления старых записей попыток входа из базы данных.

### 6. Управление блокировками

*   **Назначение:** Просмотр и управление всеми заблокированными IP-адресами (временными, постоянными, через `.htaccess`).
*   **Поиск и пагинация:** Удобный поиск по IP-адресам и пагинация для больших списков.
*   **Разблокировка:** Возможность разблокировать IP-ададреса вручную.
*   **История:** Просмотр подробной истории попыток входа для конкретного IP-адреса.
*   **История разблокировок:** Журнал всех ручных разблокировок.
*   **Добавить IP в черный список:** Ручное добавление IP-адресов или CIDR-диапазонов в постоянный черный список.

### 7. Белый список

*   **Назначение:** IP-адреса, добавленные в этот список, никогда не будут заблокированы системой, даже при множественных неудачных попытках входа или других нарушениях.
*   **Форматы:** Поддерживаются те же форматы, что и для блокировки IP (отдельные IP, CIDR, ASN).
*   **Управление:** Добавление и удаление IP-адресов из белого списка.

### 8. Статус системы

*   **Назначение:** Обзор состояния компонентов плагина и активных защит.
*   **Информация:** Проверяет доступность `.htaccess` для записи, состояние директорий резервных копий и кэша ASN, наличие таблиц базы данных плагина, а также отображает ваш текущий IP.
*   **Активные защиты:** Показывает, какие модули защиты активны и сколько записей они содержат.
*   **Действия:** Кнопки для создания резервной копии `.htaccess` и очистки всего кэша плагина.

## Разработка

Плагин использует стандартные хуки WordPress (`admin_menu`, `admin_init`, `wp_login_failed` и т.д.) для интеграции своих функций. Для взаимодействия с пользователем используется AJAX.

### Структура данных

*   **Таблица `{$wpdb->prefix}security_login_attempts`:** Хранит записи о попытках входа (IP-адрес, имя пользователя, время, User-Agent, статус блокировки).
*   **Таблица `{$wpdb->prefix}security_unblock_history`:** Хранит историю разблокировок IP-адресов.
*   **Опции WordPress:** Плагин использует опции WordPress для хранения настроек (например, `asb_dangerous_files`, `asb_blocked_bots`, `asb_brute_force_enabled`, `asb_whitelist_ips`, `asb_wp_blocked_ips`).

### Взаимодействие с .htaccess

Плагин вставляет свои правила в файл `.htaccess` с использованием специальных маркеров (`# IP_BLOCKER_SAFE_MARKER`, `# LOGIN_PROTECTION_MARKER`, `# DANGEROUS_FILES_MARKER`, `# BOT_PROTECTION_MARKER`). Это позволяет плагину управлять только своими секциями, не затрагивая другие правила в файле.

### Кэширование ASN

Для повышения производительности и снижения нагрузки на внешние API, плагин кэширует IP-диапазоны, полученные по ASN, в директории `wp-content/security-blocker-cache/`. Кэш обновляется каждые 24 часа.

### Очистка кэша

Класс `ASB_Cache_Handler` предоставляет методы для очистки различных типов кэша, включая браузерный, OPcache, Redis, Memcached и кэш популярных плагинов WordPress (W3 Total Cache, WP Super Cache, WP Rocket).

## Часто задаваемые вопросы

**В: Мой сайт перестал работать после активации плагина или изменения настроек. Что делать?**
О: Скорее всего, вы заблокировали свой собственный IP-адрес.
    1.  **Через FTP/SSH:** Подключитесь к вашему серверу по FTP или SSH.
    2.  **Найдите .htaccess:** Перейдите в корневую директорию вашего WordPress и найдите файл `.htaccess`.
    3.  **Удалите правила плагина:** Откройте `.htaccess` и удалите все секции, заключенные между маркерами плагина (например, `# IP_BLOCKER_SAFE_MARKER` ... `# IP_BLOCKER_SAFE_MARKER`).
    4.  **Восстановите из резервной копии:** Если вы делали резервную копию, вы можете восстановить её из директории `wp-content/security-blocker-backups/`.
    5.  **Деактивируйте плагин:** Если проблема сохраняется, временно деактивируйте плагин, переименовав его директорию (`wp-content/plugins/advanced-security-ip-blocker/`).
    6.  **Добавьте свой IP в белый список:** После восстановления доступа, обязательно добавьте свой IP-адрес в белый список на вкладке "Защита wp-login.php и xmlrpc.php" или "Белый список".

**В: Почему мой IP-адрес автоматически блокируется?**
О: Это происходит, если вы превышаете лимит неудачных попыток входа, установленный на вкладке "Защита от брутфорс атак". Проверьте настройки и при необходимости увеличьте лимит или добавьте свой IP в белый список.

**В: Поддерживает ли плагин IPv6?**
О: Да, плагин поддерживает блокировку и разрешение IP-адресов IPv4 и IPv6, а также CIDR-диапазонов для обоих протоколов.

**В: Как часто обновляется статистика на вкладке "Защита от брутфорс атак"?**
О: Статистика обновляется автоматически каждые 30 секунд. Вы также можете обновить её вручную, нажав кнопку "Обновить сейчас".

**В: Что происходит при деактивации плагина?**
О: При деактивации плагин пытается удалить все свои правила из файла `.htaccess`, чтобы избежать конфликтов. Однако, настройки плагина в базе данных сохраняются.

**В: Что происходит при удалении плагина?**
О: При удалении плагина (через меню "Плагины" -> "Удалить") происходит полная очистка: удаляются все правила из `.htaccess`, все опции плагина из базы данных, а также таблицы с попытками входа и историей разблокировок. Директории резервных копий и кэша также удаляются.

## Лицензия

Этот плагин распространяется под лицензией GPL-2.0. Подробности смотрите в файле `LICENSE`.

## Автор

Robert Bennett
[GitHub Профиль](https://github.com/RobertoBennett/Advanced-Security-IP-Blocker)

---
